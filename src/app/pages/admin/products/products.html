<div class="container-fluid">
  <div class="row g-4 align-items-start">

    <!-- ========================= -->
    <!-- PRODUCT LIST COLUMN -->
    <!-- ========================= -->
    <div [ngClass]="isSidePanelVisible ? 'col-lg-8' : 'col-lg-12'">

      <div class="card shadow-sm card-accent">
        <div class="card-header bg-white d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Product List</h5>
          <button class="btn btn-primary btn-sm" (click)="viewSidePanel()">
            + New Product
          </button>
        </div>

        <div class="card-body">

          <!-- LOADER -->
          @if (isLoadingProducts) {
            <div class="text-center py-5">
              <div class="spinner-border text-success" role="status"></div>
              <p class="mt-2 text-muted">Loading products...</p>
            </div>
          }

          <!-- CONTENT -->
          @else {

            @if (!products || products.length === 0){
            <div class="text-center text-muted py-4">
                No products available.
              </div>
            }

            @else {
              <div class="row g-4">

                @for (product of products; track product.productId) {
                  <div class="col-md-6 col-lg-4">
                    <div class="card product-card h-100 shadow-sm">

                      <img [src]="product.productImageUrl"
                           class="card-img-top product-img"
                           alt="product image">

                      <div class="card-body d-flex flex-column">

                        <h6 class="fw-bold mb-1">
                          {{ product.productName }}
                        </h6>

                        <p class="text-success fw-semibold mb-3">
                          ₹ {{ product.productPrice }}
                        </p>

                        <button class="btn btn-outline-success btn-sm mt-auto"
                                (click)="viewProduct(product)">
                          View Details
                        </button>

                      </div>
                    </div>
                  </div>
                }

              </div>
            }

          }

        </div>
      </div>

    </div>


    <!-- ========================= -->
    <!-- SIDE PANEL COLUMN -->
    <!-- ========================= -->
    @if (isSidePanelVisible) {

      <div class="col-lg-4">

        <div class="card shadow-sm card-accent h-100">

          <div class="card-header bg-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0">New Product</h5>
            <button class="btn btn-sm btn-outline-danger"
                    (click)="closeSidePanel()">×</button>
          </div>

          <div class="card-body">

            <form [formGroup]="productForm" (ngSubmit)="saveProduct()">

              <!-- ROW 1 -->
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label fw-semibold">SKU</label>
                  <input type="text"
                         class="form-control"
                         formControlName="productSku">
                </div>

                <div class="col-md-6 mb-3">
                  <label class="form-label fw-semibold">Name</label>
                  <input type="text"
                         class="form-control"
                         formControlName="productName">
                </div>
              </div>

              <!-- ROW 2 -->
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label fw-semibold">Short Name</label>
                  <input type="text"
                         class="form-control"
                         formControlName="productShortName">
                </div>

                <div class="col-md-6 mb-3">
                  <label class="form-label fw-semibold">Price</label>
                  <input type="number"
                         class="form-control"
                         formControlName="productPrice">
                </div>
              </div>

              <!-- CATEGORY + DELIVERY -->
              <div class="row">

                <div class="col-md-6 mb-3">
                  <label class="form-label fw-semibold">Category</label>

                  <select class="form-select"
                          formControlName="categoryId">

                    <option value="" disabled>
                      Select Category
                    </option>

                    @for (cat of categories; track cat.categoryId) {
                      <option [value]="cat.categoryId">
                        {{ cat.categoryName }}
                      </option>
                    }

                  </select>
                </div>

                <div class="col-md-6 mb-3">
                  <label class="form-label fw-semibold">Delivery Time Span</label>
                  <input type="text"
                         class="form-control"
                         formControlName="deliveryTimeSpan">
                </div>

              </div>

              <!-- IMAGE -->
              <div class="mb-3">
                <label class="form-label fw-semibold">Image URL</label>
                <input type="text"
                       class="form-control"
                       formControlName="productImageUrl">
              </div>

              <!-- DESCRIPTION -->
              <div class="mb-4">
                <label class="form-label fw-semibold">Description</label>
                <textarea rows="4"
                          class="form-control"
                          formControlName="productDescription">
                </textarea>
              </div>

              <button type="submit" class="btn btn-success w-100">
                Save Product
              </button>

            </form>

          </div>
        </div>

      </div>

    }

  </div>
</div>
